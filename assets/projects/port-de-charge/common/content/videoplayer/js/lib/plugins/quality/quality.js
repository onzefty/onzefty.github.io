/*! Copyright Â© Onlineformapro 2019. Build:2019-09-26 */
"use strict";mejs.i18n.en["mejs.quality-chooser"]="Quality Chooser",Object.assign(mejs.MepDefaults,{defaultQuality:"auto",qualityText:null}),Object.assign(MediaElementPlayer.prototype,{buildquality:function(a,b,c,d){for(var e=this,f=e.mediaFiles?e.mediaFiles:e.node.children,g=new Map,h=0,i=f.length;i>h;h++){var j=f[h],k=j instanceof HTMLElement?j.getAttribute("data-quality"):j["data-quality"];if(e.mediaFiles){var l=document.createElement("source");l.src=j.src,l.type=j.type,e.addValueToKey(g,k,l)}else"SOURCE"===j.nodeName&&e.addValueToKey(g,k,j)}if(!(g.size<=1)){e.cleanquality(a);var m=mejs.Utils.isString(e.options.qualityText)?e.options.qualityText:mejs.i18n.t("mejs.quality-chooser"),n=function(a){var b;if("auto"===a){var c=e.keyExist(g,a);if(c)b=a;else{var d=e.getMapIndex(g,0);b=d.key}}else b=a;return b},o=n(e.options.defaultQuality);a.qualitiesButton=document.createElement("div"),a.qualitiesButton.className="".concat(e.options.classPrefix,"button ").concat(e.options.classPrefix,"qualities-button"),a.qualitiesButton.innerHTML='<button type="button" aria-controls="'.concat(e.id,'" title="').concat(m,'" ')+'aria-label="'.concat(m,'" tabindex="0">').concat(o,"</button>")+'<div class="'.concat(e.options.classPrefix,"qualities-selector ").concat(e.options.classPrefix,'offscreen">')+'<ul class="'.concat(e.options.classPrefix,'qualities-selector-list"></ul>')+"</div>",e.addControlElement(a.qualitiesButton,"qualities"),d.setSrc(g.get(o)[0].src),d.load(),g.forEach(function(b,c){if("map_keys_1"!==c){var d=b[0],f=c,g="".concat(e.id,"-qualities-").concat(f);a.qualitiesButton.querySelector("ul").innerHTML+='<li class="'.concat(e.options.classPrefix,'qualities-selector-list-item">')+'<input class="'.concat(e.options.classPrefix,'qualities-selector-input" type="radio" name="').concat(e.id,'_qualities"')+'disabled="disabled" value="'.concat(f,'" id="').concat(g,'"  ')+"".concat(f===o?' checked="checked"':"","/>")+'<label for="'.concat(g,'" class="').concat(e.options.classPrefix,"qualities-selector-label")+"".concat(f===o?" ".concat(e.options.classPrefix,"qualities-selected"):"",'">')+"".concat(d.title||f,"</label>")+"</li>"}});for(var p=["mouseenter","focusin"],q=["mouseleave","focusout"],r=a.qualitiesButton.querySelectorAll('input[type="radio"]'),s=a.qualitiesButton.querySelectorAll(".".concat(e.options.classPrefix,"qualities-selector-label")),t=a.qualitiesButton.querySelector(".".concat(e.options.classPrefix,"qualities-selector")),u=0,v=p.length;v>u;u++)a.qualitiesButton.addEventListener(p[u],function(){mejs.Utils.removeClass(t,"".concat(e.options.classPrefix,"offscreen")),t.style.height="".concat(t.querySelector("ul").offsetHeight,"px"),t.style.top="".concat(-1*parseFloat(t.offsetHeight),"px")});for(var w=0,x=q.length;x>w;w++)a.qualitiesButton.addEventListener(q[w],function(){mejs.Utils.addClass(t,"".concat(e.options.classPrefix,"offscreen"))});for(var y=0,z=r.length;z>y;y++){var A=r[y];A.disabled=!1,A.addEventListener("change",function(){for(var b=this,c=b.value,f=a.qualitiesButton.querySelectorAll(".".concat(e.options.classPrefix,"qualities-selected")),h=0,i=f.length;i>h;h++)mejs.Utils.removeClass(f[h],"".concat(e.options.classPrefix,"qualities-selected"));b.checked=!0;for(var j=mejs.Utils.siblings(b,function(a){return mejs.Utils.hasClass(a,"".concat(e.options.classPrefix,"qualities-selector-label"))}),k=0,l=j.length;l>k;k++)mejs.Utils.addClass(j[k],"".concat(e.options.classPrefix,"qualities-selected"));var m=d.currentTime,n=d.paused;a.qualitiesButton.querySelector("button").innerHTML=c,n||d.pause(),e.updateVideoSource(d,g,c),d.setSrc(g.get(c)[0].src),d.load(),d.dispatchEvent(mejs.Utils.createEvent("seeking",d)),n||d.play(),d.addEventListener("canplay",function o(){d.setCurrentTime(m),d.removeEventListener("canplay",o)})})}for(var B=0,C=s.length;C>B;B++)s[B].addEventListener("click",function(){var a=mejs.Utils.siblings(this,function(a){return"INPUT"===a.tagName})[0],b=mejs.Utils.createEvent("click",a);a.dispatchEvent(b)});t.addEventListener("keydown",function(a){a.stopPropagation()}),d.setSrc(g.get(o)[0].src)}},cleanquality:function(a){a&&a.qualitiesButton&&a.qualitiesButton.remove()},addValueToKey:function(a,b,c){a.has("map_keys_1")?a.get("map_keys_1").push(b.toLowerCase()):a.set("map_keys_1",[]),a.has(b)?a.get(b).push(c):(a.set(b,[]),a.get(b).push(c))},updateVideoSource:function(a,b,c){this.cleanMediaSource(a);for(var d=b.get(c),e=function(b){var c=a.children[b];"VIDEO"===c.tagName&&d.forEach(function(a){c.appendChild(a)})},f=0;f<a.children.length;f++)e(f)},cleanMediaSource:function(a){for(var b=0;b<a.children.length;b++){var c=a.children[b];if("VIDEO"===c.tagName)for(;c.firstChild;)c.removeChild(c.firstChild)}},getMapIndex:function(a,b){var c=-1,d={};return a.forEach(function(a,e){c===b&&(d.key=e,d.value=a),c++}),d},keyExist:function(a,b){return-1<a.get("map_keys_1").indexOf(b.toLowerCase())}});