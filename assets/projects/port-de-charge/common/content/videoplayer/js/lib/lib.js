/*! Copyright Â© Onlineformapro 2019. Build:2019-09-26 */
function ofp_getQueryStringParameter(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null}function ofp_messageListener(a){try{if(!a.origin||a.origin.indexOf(ofp_distHost)<0)return;if(a.data){var b=JSON.parse(a.data);if("setLocalSCORMData"!=b.method)return;var c=b.data;pipwerks.SCORM.data.local=c,c["cmi.interactions._count"]>0&&Object.keys(c).map(function(a){"cmi.interactions"==a.substr(0,16)&&a.indexOf("_count")<0}),ofp_distantSCORMAPILoaded=!0}}catch(d){}}var pipwerks={};if(pipwerks.UTILS={},pipwerks.debug={isActive:!0},pipwerks.SCORM={version:null,handleCompletionStatus:!0,handleExitMode:!0,API:{handle:null,isFound:!1},connection:{isActive:!1},data:{completionStatus:null,exitStatus:null,local:{}},debug:{}},pipwerks.SCORM.isAvailable=function(){return!0},pipwerks.SCORM.API.find=function(a){for(var b=null,c=0,d=500,e="SCORM.API.find",f=pipwerks.UTILS.trace,g=pipwerks.SCORM;!a.API&&!a.API_1484_11&&a.parent&&a.parent!=a&&d>=c;)c++,a=a.parent;if(g.version)switch(g.version){case"2004":a.API_1484_11?b=a.API_1484_11:f(e+": SCORM version 2004 was specified by user, but API_1484_11 cannot be found.");break;case"1.2":a.API?b=a.API:f(e+": SCORM version 1.2 was specified by user, but API cannot be found.")}else a.API_1484_11?(g.version="2004",b=a.API_1484_11):a.API&&(g.version="1.2",b=a.API);return b?(f(e+": API found. Version: "+g.version),f("API: "+b)):f(e+": Error finding API. \nFind attempts: "+c+". \nFind attempt limit: "+d),b},pipwerks.SCORM.API.get=function(){var a=null,b=window,c=pipwerks.SCORM,d=c.API.find,e=pipwerks.UTILS.trace;return b.parent&&b.parent!=b&&(a=d(b.parent)),!a&&b.top.opener&&(a=d(b.top.opener)),!a&&b.top.opener&&b.top.opener.document&&(a=d(b.top.opener.document)),a?c.API.isFound=!0:e("API.get failed: Can't find the API!"),a},pipwerks.SCORM.API.getHandle=function(){var a=pipwerks.SCORM.API;return a.handle||a.isFound||(a.handle=a.get()),a.handle},pipwerks.SCORM.connection.initialize=function(){var a=!1,b=pipwerks.SCORM,c=b.data.completionStatus,d=pipwerks.UTILS.trace,e=pipwerks.UTILS.StringToBoolean,f=b.debug,g="SCORM.connection.initialize ";if(d("connection.initialize called."),b.connection.isActive)d(g+"aborted: Connection already active.");else{var h=b.API.getHandle(),i=0;if(h){switch(b.version){case"1.2":a=e(h.LMSInitialize(""));break;case"2004":a=e(h.Initialize(""))}if(a)if(i=f.getCode(),null!==i&&0===i){if(b.connection.isActive=!0,b.handleCompletionStatus&&(c=b.status("get")))switch(c){case"not attempted":b.status("set","incomplete");break;case"unknown":b.status("set","incomplete")}}else a=!1,d(g+"failed. \nError code: "+i+" \nError info: "+f.getInfo(i));else i=f.getCode(),d(null!==i&&0!==i?g+"failed. \nError code: "+i+" \nError info: "+f.getInfo(i):g+"failed: No response from server.")}else d(g+"failed: API is null.")}return a},pipwerks.SCORM.connection.terminate=function(){var a=!1,b=pipwerks.SCORM,c=b.data.exitStatus,d=(b.data.completionStatus,pipwerks.UTILS.trace),e=pipwerks.UTILS.StringToBoolean,f=b.debug,g="SCORM.connection.terminate ";if(b.connection.isActive){var h=b.API.getHandle(),i=0;if(h){if(b.handleExitMode&&!c)switch(b.version){case"1.2":a=b.set("cmi.core.exit","suspend");break;case"2004":a=b.set("cmi.exit","suspend")}switch(b.version){case"1.2":a=e(h.LMSFinish(""));break;case"2004":a=e(h.Terminate(""))}a?b.connection.isActive=!1:(i=f.getCode(),d(g+"failed. \nError code: "+i+" \nError info: "+f.getInfo(i)))}else d(g+"failed: API is null.")}else d(g+"aborted: Connection already terminated.");return a},pipwerks.SCORM.data.get=function(a){var b=null,c=pipwerks.SCORM,d=pipwerks.UTILS.trace,e=c.debug,f="SCORM.data.get("+a+") ";if(c.connection.isActive){var g=c.API.getHandle(),h=0;if(g){switch(c.version){case"1.2":b=g.LMSGetValue(a);break;case"2004":b=g.GetValue(a)}if(h=e.getCode(),""!==b||0===h)switch(a){case"cmi.core.lesson_status":case"cmi.completion_status":c.data.completionStatus=b;break;case"cmi.core.exit":case"cmi.exit":c.data.exitStatus=b}else d(f+"failed. \nError code: "+h+"\nError info: "+e.getInfo(h))}else d(f+"failed: API is null.")}else d(f+"failed: API connection is inactive.");return d(f+" value: "+b),String(b)},pipwerks.SCORM.data.set=function(a,b){var c=!1,d=pipwerks.SCORM,e=pipwerks.UTILS.trace,f=pipwerks.UTILS.StringToBoolean,g=d.debug,h="SCORM.data.set("+a+") ";if(d.connection.isActive){var i=d.API.getHandle(),j=0;if(i){switch(d.version){case"1.2":c=f(i.LMSSetValue(a,b));break;case"2004":c=f(i.SetValue(a,b))}c?("cmi.core.lesson_status"===a||"cmi.completion_status"===a)&&(d.data.completionStatus=b):e(h+"failed. \nError code: "+j+". \nError info: "+g.getInfo(j))}else e(h+"failed: API is null.")}else e(h+"failed: API connection is inactive.");return c},pipwerks.SCORM.data.save=function(){var a=!1,b=pipwerks.SCORM,c=pipwerks.UTILS.trace,d=pipwerks.UTILS.StringToBoolean,e="SCORM.data.save failed";if(b.connection.isActive){var f=b.API.getHandle();if(f)switch(b.version){case"1.2":a=d(f.LMSCommit(""));break;case"2004":a=d(f.Commit(""))}else c(e+": API is null.")}else c(e+": API connection is inactive.");return a},pipwerks.SCORM.status=function(a,b){var c=!1,d=pipwerks.SCORM,e=pipwerks.UTILS.trace,f="SCORM.getStatus failed",g="";if(null!==a){switch(d.version){case"1.2":g="cmi.core.lesson_status";break;case"2004":g="cmi.completion_status"}switch(a){case"get":c=d.data.get(g);break;case"set":null!==b?c=d.data.set(g,b):(c=!1,e(f+": status was not specified."));break;default:c=!1,e(f+": no valid action was specified.")}}else e(f+": action was not specified.");return c},pipwerks.SCORM.debug.getCode=function(){var a=pipwerks.SCORM,b=a.API.getHandle(),c=pipwerks.UTILS.trace,d=0;if(b)switch(a.version){case"1.2":d=parseInt(b.LMSGetLastError(),10);break;case"2004":d=parseInt(b.GetLastError(),10)}else c("SCORM.debug.getCode failed: API is null.");return d},pipwerks.SCORM.debug.getInfo=function(a){var b=pipwerks.SCORM,c=b.API.getHandle(),d=pipwerks.UTILS.trace,e="";if(c)switch(b.version){case"1.2":e=c.LMSGetErrorString(a.toString());break;case"2004":e=c.GetErrorString(a.toString())}else d("SCORM.debug.getInfo failed: API is null.");return String(e)},pipwerks.SCORM.debug.getDiagnosticInfo=function(a){var b=pipwerks.SCORM,c=b.API.getHandle(),d=pipwerks.UTILS.trace,e="";if(c)switch(b.version){case"1.2":e=c.LMSGetDiagnostic(a);break;case"2004":e=c.GetDiagnostic(a)}else d("SCORM.debug.getDiagnosticInfo failed: API is null.");return String(e)},null!=ofp_getQueryStringParameter("disthost")&&""!=ofp_getQueryStringParameter("disthost")){ofp_distHost=ofp_getQueryStringParameter("disthost"),ofp_waitForDistantSCORMAPI=!0,ofp_distantSCORMAPILoaded=!1;var ofp_messageHost=location.protocol+ofp_distHost;ofp_messageHost.indexOf("//")<0&&(ofp_messageHost=location.protocol+"//"+ofp_distHost),window.addEventListener?addEventListener("message",ofp_messageListener,!1):attachEvent("onmessage",ofp_messageListener),pipwerks.SCORM.init=function(){API=!0,window.parent.postMessage(JSON.stringify({method:"scorm.init",arguments:arguments}),ofp_messageHost),pipwerks.SCORM.connection.isActive=!0},pipwerks.SCORM.get=function(a){var b="undefined"!=typeof pipwerks.SCORM.data.local[a]?pipwerks.SCORM.data.local[a]:"";return b},pipwerks.SCORM.set=function(){window.parent.postMessage(JSON.stringify({method:"scorm.set",arguments:arguments}),ofp_messageHost);try{if(arguments[0].indexOf("cmi.interactions")>=0){var a=arguments[0].split(".");if(a.length>3){var b=parseInt(a[2]);pipwerks.SCORM.data.local["cmi.interactions._count"]=b+1}}else if(arguments[0].indexOf("cmi.objectives")>=0){var a=arguments[0].split(".");if(a.length>3){var c=parseInt(a[2]);pipwerks.SCORM.data.local["cmi.objectives._count"]=c+1}}}catch(d){}pipwerks.SCORM.data.local[arguments[0]]=arguments[1]},pipwerks.SCORM.save=function(){window.parent.postMessage(JSON.stringify({method:"scorm.save",arguments:arguments}),ofp_messageHost)},pipwerks.SCORM.quit=function(){window.parent.postMessage(JSON.stringify({method:"scorm.quit",arguments:arguments}),ofp_messageHost)},pipwerks.SCORM.init(),window.parent.postMessage(JSON.stringify({method:"scorm.preload",arguments:[]}),ofp_messageHost)}else pipwerks.SCORM.init=pipwerks.SCORM.connection.initialize,pipwerks.SCORM.get=pipwerks.SCORM.data.get,pipwerks.SCORM.set=pipwerks.SCORM.data.set,pipwerks.SCORM.save=pipwerks.SCORM.data.save,pipwerks.SCORM.quit=pipwerks.SCORM.connection.terminate;pipwerks.UTILS.StringToBoolean=function(a){var b=typeof a;switch(b){case"object":case"string":return/(true|1)/i.test(a);case"number":return!!a;case"boolean":return a;case"undefined":return null;default:return!1}},pipwerks.UTILS.trace=function(a){pipwerks.debug.isActive&&window.console&&window.console.log&&console.log(a)};